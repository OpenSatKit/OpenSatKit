<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.4.5" />
<title>CFS-101 TRAINING GUIDE</title>
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock {
  padding-left: 2.0em;
  margin-right: 10%;
}
div.verseblock > div.content {
  white-space: pre;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock-content {
  white-space: pre;
}
div.verseblock-attribution {
  padding-top: 0.75em;
  text-align: left;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){generateToc(6)}
/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, October 2006. License: GPL */

function getText(el) {
  var text = "";
  for (var i = el.firstChild; i != null; i = i.nextSibling) {
    if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
      text += i.data;
    else if (i.firstChild != null)
      text += getText(i);
  }
  return text;
}

function TocEntry(el, text, toclevel) {
  this.element = el;
  this.text = text;
  this.toclevel = toclevel;
}

function tocEntries(el, toclevels) {
  var result = new Array;
  var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
  // Function that scans the DOM tree for header elements (the DOM2
  // nodeIterator API would be a better technique but not supported by all
  // browsers).
  var iterate = function (el) {
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
        var mo = re.exec(i.tagName)
        if (mo)
          result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
        iterate(i);
      }
    }
  }
  iterate(el);
  return result;
}

// This function does the work. toclevels = 1..4.
function generateToc(toclevels) {
  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementsByTagName("body")[0], toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "toc" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    document.getElementById("header").removeChild(toc);
}
/*]]>*/
</script>
</head>
<body>
<div id="header">
<h1>CFS-101 TRAINING GUIDE</h1>
<span id="author">Using open source version of CFE/CFS/OSAL from sourceforge.net</span><br />
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="preamble">
<div class="sectionbody">
<hr />
</div>
</div>
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>This is the training guide for CFS-101 self-guided tutorial. This tutorial is designed
to show the steps for creating, building &amp; running a simple CFS-based software system.
It is not designed to dive into detailed designs of the CFE framework or its included
CFS applications. Documentations that are packaged with the source code should provide
more insight into the designs.</p></div>
<div class="paragraph"><p>By the end of this tutorial, you will be able to create, build &amp; run a simple CFS-based
software system that can</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
be commanded from a ground system
</p>
</li>
<li>
<p>
provide input data to the system
</p>
</li>
<li>
<p>
publish &amp; subscribe data to/from the rest of the system
</p>
</li>
<li>
<p>
process &amp; monitor the data
</p>
</li>
<li>
<p>
downlink the output data to a ground system
</p>
</li>
</ol></div>
<h3 id="_training_prerequisites">1.1. Training prerequisites</h3><div style="clear:left"></div>
<div class="paragraph"><p>To take this tutorial, you should know</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
how to program in C
</p>
</li>
<li>
<p>
how to use Linux OS
</p>
</li>
</ol></div>
<h3 id="_training_materials">1.2. Training Materials</h3><div style="clear:left"></div>
<div class="paragraph"><p>This training guide is used with a Virtual Machine (VM) called
<span style="color: green;">CentOS-6.9-oss-CFS-101</span>. Log in to the VM as <span style="color: green;">"dev"</span> user with password
<span style="color: green;">"cfs101!!"</span>.</p></div>
<div class="paragraph"><p>The development environment for this VM has been setup &amp; configured with the
appropriate system libraries, open-source version of the CFS software, and project
workspace for the training.</p></div>
<div class="exampleblock">
<div class="exampleblock-content">
<div class="paragraph"><p><span style="color: purple;background-color: bold;">NOTE that due to NASA IT policy,</span> <span style="color: green;">dev</span> <span style="color: purple;background-color: bold;">user is not
setup as superuser and</span> <span style="color: green;">root</span> <span style="color: purple;background-color: bold;">password will not be provided.
This VM is meant to be used solely for the purpose of this training.</span></p></div>
</div></div>
</div>
<h2 id="_the_cfs_anatomy">2. The CFS Anatomy</h2>
<div class="sectionbody">
<div class="paragraph"><p>In a nutshell, the Core Flight Software architecture look like <a href="cfe.html">THIS</a>
and <a href="cfs.html">THIS</a>.</p></div>
<div class="paragraph"><p>This section describes the source code&#8217;s directory trees.</p></div>
<div class="paragraph"><p>Either due to preferences or requirements, a CFS-based project can be setup differently
from others in terms of where directories &amp; files are located. Regardless of how the
project is setup, the 6 top-level CFS directories must exist with their sub-directories
&amp; contents as pictured in below links.</p></div>
<div class="paragraph"><p>Note that it is not required for these top-level directories to be under the same
parent directory. However, their sub-directories must be atleast as shown in the
pictures.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
<a href="cfe-dirs.html">cfe</a><br />
<br />
       This directory contains source code for the Core Flight Executives
       (<span style="color: fuchsia;">CFE</span>) layer. It is a set of mission-independent,
       re-usable, core software services, which includes the Executive Services
       (<span style="color: fuchsia;">ES</span>), the Event Services (<span style="color: fuchsia;">EVS</span>), the
       Software Bus Services (<span style="color: fuchsia;">SB</span>), the Table Services (<span style="color: fuchsia;">TBL</span>),
       the Time Services (<span style="color: fuchsia;">TIME</span>) and the File Services (<span style="color: fuchsia;">FS</span>).
       These services run as child threads on non-realtime OS like Linux and as
       tasks on realtime OS like vxWorks.
</p>
</li>
<li>
<p>
<a href="osal-dirs.html">osal</a><br />
<br />
       This directory contains source code for the OS Abstraction Layer
       (<span style="color: fuchsia;">OSAL</span>). It provides a common set of Application Programmer
       Interfaces (APIs) at the OS level. Using the APIs, CFS applications can be
       coded as OS-independent, making them more portable between different platforms.
</p>
</li>
<li>
<p>
<a href="psp-dirs.html">psp</a><br />
<br />
       This directory contains source code for the Platform Support Package
       (<span style="color: fuchsia;">PSP</span>) layer. Like the OSAL, it also provides a
       set of common APIs, but at the processor level.
</p>
</li>
<li>
<p>
<a href="apps-dirs.html">apps</a><br />
<br />
       This directory contains source code for the CFS applications,
       including both re-use and mission-specific applications. Commonly referred
       to as <span style="color: fuchsia;">apps</span>, they run as child threads on non-realtime
       OS like Linux and as tasks on realtime OS like vxWorks.
</p>
</li>
<li>
<p>
<a href="cfs101-defs-dirs.html">cfs101_defs</a><br />
<br />
       This directory contains build configuration files for cmake.
</p>
</li>
<li>
<p>
<a href="tools-dirs.html">tools</a><br />
<br />
       This directory contains source code for the supporting tools,
       including both re-use and mission-specific tools<br />
<br />
Unlike the others, there&#8217;s no requirement on how things are layed out in
the <span style="color: fuchsia;">tools</span> directory. It is recommended, however, that each tool
has its own sub-directory. Some tools do come with the CFE release.
</p>
</li>
</ol></div>
<div class="paragraph"><p>For CFS-101 VM, all 6 top-level directories are located under the same parent
directory in the workspace, <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101</span>.
Note that it is okay to use symbolic links for these directories if desired.
The <span style="color: fuchsia;">CFS-101 &amp; osal</span> directories are setup that way for this training.
Also keep in mind that this setup might not, and does not have to, work for all
CFS-based projects. For example, one project might group them as core (cfe, osal, psp)
vs. mission-specific (apps, build, tools) for purpose of version control management.<br />
<br />
You should now traverse inside <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101</span>
directory to get a feel for where things are.</p></div>
</div>
<h2 id="_getting_started_with_the_initial_flight_system">3. Getting Started With The Initial Flight System</h2>
<div class="sectionbody">
<div class="paragraph"><p>Let&#8217;s now walk through the steps to build &amp; run a simple CFS-based system,
starting with system descriptions.</p></div>
<div class="exampleblock">
<div class="exampleblock-content">
<div class="paragraph"><p><span style="color: purple;background-color: bold;">NOTE that if you want to reset the workspace to the intial state at any
point in the tutorial, execute the following commands,</span></p></div>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace
$ rm -rf CFS-101.initial
$ tar zxvf ../Archives/CFS-101.initial.tar.gz
$ rm CFS-101
$ ln -s CFS-101.initial CFS-101</tt></pre>
</div></div>
</div></div>
<div class="exampleblock">
<div class="exampleblock-content">
<div class="paragraph"><p><span style="color: purple;background-color: bold;">NOTE also that if you want to see the final workspace with all the updates,
execute the following commands,</span></p></div>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace
$ tar zxvf ../Archives/CFS-101.final.tar.gz
$ rm CFS-101
$ ln -s CFS-101.final CFS-101</tt></pre>
</div></div>
</div></div>
<h3 id="_system_components">3.1. System components</h3><div style="clear:left"></div>
<div class="paragraph"><p>This VM is setup for you to build a simple CFS-based system initially. The system
will utilize the following components:</p></div>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
<span style="color: fuchsia;">cfe</span> &#8594; core services
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">osal</span> &#8594; OS abstraction layer providing common set of APIs
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">psp</span> &#8594; platform-specific
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">apps</span> &#8594; applications
</p>
<div class="ulist"><ul>
<li>
<p>
<span style="color: fuchsia;">sch</span> &#8594; a CFS application to send out scheduled commands to
                           other apps
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">ci</span> &#8594; a CFS application to receive commands from
                          external sources
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">to</span> &#8594; a CFS application to send out telemetry to
                          external sources
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">io_lib</span> &#8594; a CFS library used by ci and to applications
</p>
</li>
</ul></div>
</li>
<li>
<p>
<span style="color: fuchsia;">tools</span> &#8594; tools
</p>
<div class="ulist"><ul>
<li>
<p>
<span style="color: fuchsia;">gen_app_code</span> &#8594; a script that generates code template for
                                    a CFS application
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">cFS-GroundSystem</span> &#8594; an application that creates ground
                                        system displays &amp; data connections
</p>
</li>
</ul></div>
</li>
</ol></div>
<h3 id="_system_behaviors">3.2. System behaviors</h3><div style="clear:left"></div>
<div class="paragraph"><p>In general, a CFS-based system behaves as described below. Note that this is not the
ONLY way a CFS-based system can be setup. This is just a more common setup.</p></div>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
At startup, it loads, starts &amp; initializes its components, CFE core and
       CFS apps, as threads or tasks.
</p>
</li>
<li>
<p>
If system startup is successful, all the components run according to their
       thread priority, as pre-defined in the <span style="color: fuchsia;">cfe_es_startup.scr</span> file.
</p>
</li>
<li>
<p>
When the <span style="color: fuchsia;">SCH</span> application runs, it continuously sends out
       <span style="color: green;">Wake-Up</span> commands to the other applications using a pre-defined
       scheduling table.
</p>
</li>
<li>
<p>
When a typical CFS application runs, it continuously listens for incoming
       commands. It does not do any "work" until it receives a <span style="color: green;">Wake-Up</span>
       command. Only upon receiving a <span style="color: green;">Wake-Up</span> command can an application
       get to run through its processing cycle (1 processing cycle per
       <span style="color: green;">Wake-Up</span> command).<br />
<br />
       An application&#8217;s processing cycle consists of 4 parts:<br />
</p>
<div class="ulist"><ul>
<li>
<p>
receiving &amp; processing commands,<br />
</p>
</li>
<li>
<p>
receiving &amp; processing input data,<br />
</p>
</li>
<li>
<p>
computing output data, and<br />
</p>
</li>
<li>
<p>
sending out output data
</p>
</li>
</ul></div>
</li>
<li>
<p>
Non-typical CFS applications, like <span style="color: fuchsia;">SCH</span>, <span style="color: fuchsia;">CI</span> &amp;
       <span style="color: fuchsia;">TO</span>, are not scheduled. <span style="color: fuchsia;">SCH</span> is typically setup
       to run at the system&#8217;s minor frame rate; whereas <span style="color: fuchsia;">CI</span> &amp;
       <span style="color: fuchsia;">TO</span> can be setup to run on scheduled, or on a pre-defined
       periodic rate, or both. Mission requirements should dictate how these
       applications be configured to run.
</p>
</li>
</ol></div>
<div class="paragraph"><p>For this tutorial, when you build &amp; run your simple system initially, it doesn&#8217;t
do much but responding to <span style="color: green;">Send-Hk</span> command from the <span style="color: fuchsia;">SCH</span>
application and <span style="color: green;">No-Op</span> &amp; <span style="color: green;">Reset</span> commands from a ground system.</p></div>
<div class="paragraph"><p>In later sections, you will be adding new applications to the system to make it do
something more substantial.</p></div>
<h3 id="_setting_the_build_environment_variables">3.3. Setting the build environment variables</h3><div style="clear:left"></div>
<div class="paragraph"><p>Being able to build CFS relies on setting your build environment variables correctly.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Open a new terminal to build &amp; run CFS system. (From hereon it will be referred
   to as the <span style="color: orange;">FSW Terminal</span>, where CFS is built &amp; run from.)
</p>
</li>
<li>
<p>
Go to <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101</span> directory.
   This will be your project&#8217;s home directory for the tutorial.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101</tt></pre>
</div></div>
</li>
<li>
<p>
Set the environment variables for this terminal session by executing the
   following command,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ source setvars.sh</tt></pre>
</div></div>
</li>
</ol></div>
<div class="paragraph"><p>You can browse through the file, <span style="color: fuchsia;">setvars.sh</span>, and see how these build
environment variables are defined. <a href="setvars-sample.html">HERE</a> is a sample
of such file.</p></div>
<div class="paragraph"><p>In this VM, this file has already been set properly for the tutorial.
Hence, you don&#8217;t need to modify this file. But any other CFS-based project will need
to modify this file to reference the locations of its 6 top-level directories. The
good news is you only have to do this once per project.</p></div>
<h3 id="_building_the_initial_flight_system">3.4. Building the initial flight system</h3><div style="clear:left"></div>
<div class="paragraph"><p>From the <span style="color: orange;">FSW Terminal</span>, you should be at <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101</span> directory.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Build the initial flight system with the following commands. This build is for a Linux OS.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ make prep
$ make
$ make install</tt></pre>
</div></div>
<div class="paragraph"><p>You should see build output similar to these:
   <a href="cmake-prep-output.html">make prep OUTPUT</a>,
   <a href="cmake-output1.html">make OUTPUT</a>,
   <a href="cmake-install-output1.html">make install OUTPUT</a></p></div>
</li>
</ol></div>
<h3 id="_running_the_initial_flight_system">3.5. Running the initial flight system</h3><div style="clear:left"></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Also from the <span style="color: orange;">FSW Terminal</span>, go to the <span style="color: fuchsia;">exe</span> directory
   for the <span style="color: fuchsia;">cpu1</span> build,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/build/exe/cpu1</tt></pre>
</div></div>
</li>
<li>
<p>
Take a look at the file, <span style="color: fuchsia;">./cf/cfe_es_startup.scr</span>. It is the input data
   file for the system. It is used by the CFE Executive Services (ES) to load &amp;
   startup CFS libraries &amp; applications. You can read the comments at the end of
   the file for more detail. <a href="startup-sample.html">HERE</a> is an example of
   such file.<br />
<br />
   Note what is included in the <span style="color: fuchsia;">cfe_es_startup.scr</span> for system run
   can be a subset of what is included in the <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/cfs101_defs/targets.cmake</span> for <span style="color: fuchsia;">cpu1</span> build. (Look for build variable
   <span style="color: green;">TGT1_APPLIST</span>.)<br />
<br />
   There is nothing wrong with building more than what you want to run with CFS.
</p>
</li>
<li>
<p>
Execute the following command to run the system,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ ./core-cpu1</tt></pre>
</div></div>
<div class="paragraph"><p>You should see output similar to <a href="run-output1.html">THIS</a>.<br />
<br />
   If an application is successfully loaded &amp; initialized, there should be an
   output line acknowledging such for each CFS application/library entry in
   the <span style="color: fuchsia;">cfe_es_startup.scr</span> file.  See an <a href="run-output1-excerpt.html">EXCERPT</a>
   from a sample run output.<br />
<br />
   After a successful system startup, it looks as though the system is not doing
   anything, but actually the <span style="color: fuchsia;">sch</span> application is cycling through its
   scheduling table, sending out scheduled commands to other parts of the system.
   You will see evidence of data being updated when you go through the next section.</p></div>
</li>
<li>
<p>
To exit the run, enter <span style="color: navy;">&lt;CTRL-C&gt;</span>.<br />
<br />
   You should see output similar to <a href="exit-output1.html">THIS</a>.
</p>
</li>
</ol></div>
<h3 id="_interacting_with_the_initial_flight_system">3.6. Interacting with the initial flight system</h3><div style="clear:left"></div>
<div class="paragraph"><p>For training purposes, let&#8217;s use the simple ground-system utilities that are
included with the CFS release to interact with your newly built system. In this
VM, the ground system runs on the same computer as the flight system. In a real
setup, a ground system would run on a different computer that has some type of
network connection to the flight computer.</p></div>
<h4 id="_sending_commands_to_the_initial_flight_system">3.6.1. Sending commands to the initial flight system</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, exit &amp; re-run the CFS executable that you built,
   i.e., <span style="color: fuchsia;">core-cpu1</span>.
</p>
</li>
<li>
<p>
Open another terminal to run the Ground System displays.
   (From hereon it will be referred to as the <span style="color: orange;">GSW Terminal</span>.)
</p>
</li>
<li>
<p>
Execute the following commands:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem
$ python GroundSystem.py</tt></pre>
</div></div>
</li>
<li>
<p>
From <a href="ground-disp1.html">cFS Ground System</a> page, click on
   <a href="ground-disp1.html">Start Command System</a> button to bring up the
   <a href="cmdgui-disp1.html">Command System Main Page</a>.
</p>
</li>
</ol></div>
<h5 id="_sending_ci_commands">Sending CI commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="cmdgui-disp1.html">Command System Main Page</a>, click the
   <a href="cmdgui-disp1.html">Display Page</a> button for the <span style="color: green;">CI Commands</span> entry
   to bring up <span style="color: fuchsia;">ci</span> <a href="ci-cmd-disp1.html">command page</a>.
</p>
</li>
<li>
<p>
From there, send the following commands, in the order listed, to <span style="color: fuchsia;">ci</span>
   by clicking the <a href="ci-cmd-disp1.html">Send</a> buttons for
   <span style="color: green;">CI_NOOP_CC</span>, <span style="color: green;">CI_RESET_CC</span>, then <span style="color: green;">CI_NOOP_CC</span> again.<br />
<br />
   You should see ground-system &amp; flight-system output similar to <a href="ci-cmd-output.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message content and
   the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
<li>
<p>
Close the <a href="ci-cmd-disp1.html">CI Commands (CPU1)</a> page.
</p>
</li>
</ol></div>
<h5 id="_sending_to_commands">Sending TO commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="cmdgui-disp1.html">Command System Main Page</a>, click the
   <a href="cmdgui-disp1.html">Display Page</a> button for the <span style="color: green;">TO Commands (CPU1)</span> entry
   to bring up <span style="color: fuchsia;">to</span> <a href="to-cmd-disp1.html">command page</a>.
</p>
</li>
<li>
<p>
From there, send the following commands, in the order listed, to <span style="color: fuchsia;">to</span>
   by clicking the <a href="to-cmd-disp1.html">Send</a> buttons for
   <span style="color: green;">TO_NOOP_CC</span>, <span style="color: green;">TO_RESET_CC</span>, then <span style="color: green;">TO_NOOP_CC</span> again.<br />
<br />
   You should see ground-system &amp; flight-system output similar to <a href="to-cmd-output.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message
   content and the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
<li>
<p>
Don&#8217;t close the <a href="to-cmd-disp1.html">TO Commands (CPU1)</a> page just yet.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Let&#8217;s now see telemetry on ground displays.</p></div>
<h4 id="_receiving_telemetry_from_the_initial_flight_system">3.6.2. Receiving telemetry from the initial flight system</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="ground-disp2.html">cFS Ground System</a> display, click the
   <a href="ground-disp2.html">Start Telemetry System</a> button to bring up the
   <a href="tlmgui-disp1.html">Telemetry System Main Page</a>.<br />
<br />
   You should expect to see no telemetry update from
   <a href="tlmgui-disp1.html">Telemetry System Main Page</a> at this point. This is
   because telemetry output from the flight system hasn&#8217;t been enabled yet.
</p>
</li>
<li>
<p>
So, from the <a href="to-cmd-disp2.html">TO Commands (CPU1)</a> page, click the
   <a href="to-cmd-disp2.html">Send</a> button for <span style="color: green;">TO_ENABLE_OUTPUT_CC</span> command
   to bring up its <a href="to-cmd-param-disp1.html">Parameter Dialog</a> display.
</p>
</li>
<li>
<p>
From the <a href="to-cmd-param-disp1.html">Parameter Dialog</a> page,
   enter "<span style="color: green;">127.0.0.1</span>" in the input box for the <span style="color: green;">cDestIp</span> parameter,
   and "<span style="color: green;">5011</span>" in the input box for the <span style="color: green;">usDestPort</span> parameter.
   Then click the <a href="to-cmd-param-disp1.html">Send</a> button at the top of the
   display page.<br />
<br />
   You should see ground-system &amp; flight-system output similar to
   <a href="to-enable-cmd-output.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message
   content and the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
<li>
<p>
Close the <a href="to-cmd-param-disp1.html">Parameter Dialog</a> page &amp; the
   <a href="to-cmd-disp2.html">TO Commands (CPU1)</a> page.
</p>
</li>
<li>
<p>
Now from the <a href="tlmgui-disp2.html">Telemetry System Main Page</a>, you should
   expect to see telemetry relating to packet counts get update periodically as
   the ground system receives telemetry from the flight system. So far only the
   telemetry from cFE core services are being received. Later on you will add more
   telemetry from the CFS applications when you go through the exercise of
   creating new CFS applications.
</p>
</li>
<li>
<p>
When you are done inspecting the data, clear out the desktop for the next section
   by closing all the Ground System displays and exit the FSW run from the
   <span style="color: orange;">FSW Terminal</span>.
</p>
</li>
</ol></div>
<h3 id="_what_8217_s_next">3.7. What&#8217;s next?</h3><div style="clear:left"></div>
<div class="paragraph"><p>If you get to this point, CONGRATULATIONS!!! You&#8217;ve just build &amp; run your first
CFS-based system.<br />
<br />
Let&#8217;s take a short break before diving into the next section, where you
will create new CFS applications that add more functionalities to the simple
system you just built &amp; run.<br />
<br />
<br /></p></div>
<hr />
<div class="paragraph"><p><span class="image">
<img src="Images/Pics/coffee-break.jpg" alt="Images/Pics/coffee-break.jpg" />
</span></p></div>
<hr />
</div>
<h2 id="_developing_a_new_flight_system">4. Developing A New Flight System</h2>
<div class="sectionbody">
<div class="paragraph"><p>Now that you know how to build &amp; run a CFS-based system, let&#8217;s enhance it to do
something more fun so you can see how data can be produced &amp; published by one
application and subscribed &amp; consumed by another application.</p></div>
<div class="paragraph"><p>Let&#8217;s implement a CFS-based system that will</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Read from a temperature sensor
</p>
</li>
<li>
<p>
Monitor the values (i.e., increasing/decreasing)
</p>
</li>
<li>
<p>
Determine the value range (i.e., nominal/hot/cold)
</p>
</li>
<li>
<p>
Set range limits on user command
</p>
</li>
<li>
<p>
Set temperature value on user command (i.e., update temperature value)
</p>
</li>
<li>
<p>
Set delta value on user command (i.e., update delta value used to compute
       next temperature value)
</p>
</li>
</ol></div>
<h3 id="_new_flight_system_design">4.1. New flight system design</h3><div style="clear:left"></div>
<div class="paragraph"><p>This system will need the following CFS applications:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
<span style="color: fuchsia;">sch</span> &#8594; to send scheduled messages to other applications
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">ci</span> &#8594; to receive user commands from ground system
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">to</span> &#8594; to send out telemetry to ground system
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">io_lib</span> &#8594; library used by <span style="color: fuchsia;">ci</span> &amp; <span style="color: fuchsia;">to</span>
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">temp_io</span> &#8594; to read &amp; publish temperature data
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">temp_mon</span> &#8594; to monitor the temperature data by subscribe to &amp;
       consume <span style="color: fuchsia;">temp_io</span>'s data
</p>
</li>
</ol></div>
<div class="paragraph"><p>Your initial system already has the first 4 covered. You now need to
add 2 new applications, <span style="color: fuchsia;">temp_io</span> and <span style="color: fuchsia;">temp_mon</span>.</p></div>
<h4 id="_temp_io_application">4.1.1. temp_io application</h4>
<div class="paragraph"><p>This application is responsible for reading &amp; publishing temperature data.
Let&#8217;s schedule it to run @ 1Hz.</p></div>
<div class="paragraph"><p>Its 3-part data processing cycle is as followed:</p></div>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
process the following commands, if received,
</p>
<div class="ulist"><ul>
<li>
<p>
<span style="color: green;">Wake-Up</span> &amp; <span style="color: green;">Send-Hk</span>
</p>
</li>
<li>
<p>
<span style="color: green;">No-Op</span> &amp; <span style="color: green;">Reset</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Current-Temp</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Delta-Value</span>
</p>
</li>
</ul></div>
</li>
<li>
<p>
read data from a temperature sensor (simulated)
</p>
</li>
<li>
<p>
publish the new temperature value
</p>
</li>
</ol></div>
<h4 id="_temp_mon_application">4.1.2. temp_mon application</h4>
<div class="paragraph"><p>This application is responsible for monitoring temperature data, determining if
the value is increasing/decreasing, &amp; labeling it as nominal/hot/cold.
Let&#8217;s also schedule it to run @ 1Hz.</p></div>
<div class="paragraph"><p>Its 4-part data processing cycle is as followed:</p></div>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
process the following commands, if received,
</p>
<div class="ulist"><ul>
<li>
<p>
<span style="color: green;">Wake-Up</span> &amp; <span style="color: green;">Send-Hk</span>
</p>
</li>
<li>
<p>
<span style="color: green;">No-Op</span> &amp; <span style="color: green;">Reset</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Cold-Limit</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Hot-Limit</span>
</p>
</li>
</ul></div>
</li>
<li>
<p>
receive the new temperature value via data subscription
</p>
</li>
<li>
<p>
compare &amp; determine<br />
</p>
<div class="ulist"><ul>
<li>
<p>
temperature change: increased/decreased
</p>
</li>
<li>
<p>
temperate range: nominal/hot/cold
</p>
</li>
</ul></div>
</li>
<li>
<p>
publish the processed data
</p>
</li>
</ol></div>
<h3 id="_initial_creation_of_the_new_applications">4.2. Initial creation of the new applications</h3><div style="clear:left"></div>
<div class="paragraph"><p>The first step is to create new applications with minimal functionalities.
Then integrate them to the initial system, and make sure they can be built &amp;
run before adding more features to them. Doing this will save you a lot of
time when you need to isolate &amp; debug issues.</p></div>
<h4 id="_creating_the_new_applications_from_a_script">4.2.1. Creating the new applications from a script</h4>
<div class="paragraph"><p>You can always implement a CFS application from scratch. You can also start with
a copy of an existing CFS application and modify it. Or you can use a script that
comes with the CFE release to generate the initial code for your application that
could be built &amp; run as-is. Let&#8217;s use the script to save you some time.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Open a new terminal to create the applications. (From hereon it will be
   referred to as the <span style="color: orange;">App Terminal</span>, where application code are
   created.)
</p>
</li>
<li>
<p>
Go to the <span style="color: fuchsia;">gen_app_code</span> directory and execute the following command
   to get information on its usage.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/tools/gen_app_code
$ python gen_app_code.py</tt></pre>
</div></div>
<div class="paragraph"><p>You should see output like <a href="gen-app-code-usage-output.html">THIS</a>.</p></div>
</li>
<li>
<p>
Execute the following command to generate code for both <span style="color: fuchsia;">temp_io</span>
   and <span style="color: fuchsia;">temp_mon</span>.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python gen_app_code.py MISSION CFS-101 OWNER "Jane Smith" OUTDIR /home/dev/Training_workspace/CFS-101/apps APPS temp_io temp_mon</tt></pre>
</div></div>
<div class="paragraph"><p>You should see output similar to <a href="gen-app-code-output.html">THIS</a>.</p></div>
</li>
<li>
<p>
Go to the <span style="color: fuchsia;">apps</span> directory and verify that 2 new directories,
   <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span>, were added.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/apps
$ ls</tt></pre>
</div></div>
</li>
</ol></div>
<div class="paragraph"><p>Feel free to take a look at the created directories &amp; generated files at this
point.</p></div>
<h4 id="_updating_the_new_applications_generated_files">4.2.2. Updating the new applications' generated files</h4>
<div class="paragraph"><p>You need to make some updates to the generated files since the script generates
default values where they should be unique across all apps.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">App Terminal</span>, go to directory,
<span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_mon/fsw/platform_inc</span>.
</p>
</li>
<li>
<p>
Open the file, <span style="color: fuchsia;">temp_mon_msgids.h</span>, &amp; replace its MID values
<a href="temp-mon-msgids-h.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Now the MID values for both <span style="color: fuchsia;">temp_io</span>'s &amp; <span style="color: fuchsia;">temp_mon</span>'s
are unique across the system.</p></div>
<h4 id="_adding_cmake_file_for_the_new_applications">4.2.3. Adding cmake file for the new applications</h4>
<div class="paragraph"><p>The current version of the <span style="color: fuchsia;">gen_app_code.py</span> script does not generate
build file for cmake just yet, so for now, you have to manually add it to the 2
new applications.</p></div>
<div class="paragraph"><p>This step will go away when the newer version of the script is distributed.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Go to the <span style="color: fuchsia;">apps</span> directory and make a copy of
<span style="color: fuchsia;">CMakeLists.txt</span> from <span style="color: fuchsia;">CI</span>.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/apps
$ cp ./ci/CMakeLists.txt ./temp_io
$ cp ./ci/CMakeLists.txt ./temp_mon</tt></pre>
</div></div>
</li>
<li>
<p>
Edit <span style="color: fuchsia;">./temp_io/CMakeLists.txt</span> <a href="temp-io-cmake.html">LIKE SO</a>.
</p>
</li>
<li>
<p>
Similarly, edit <span style="color: fuchsia;">./temp_mon/CMakeLists.txt</span> <a href="temp-mon-cmake.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h4 id="_adding_header_file_for_cfe_groundsystem_tool">4.2.4. Adding header file for cFE-GroundSystem tool</h4>
<div class="paragraph"><p>This section is only necessary if cFE-GroundSystem tool is used to build your ground system.</p></div>
<div class="paragraph"><p>Since this training uses cFE-GroundSystem tool to build ground displays,
this section is required until the tool is upgraded to handle parsing of multiple header files.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory,
<span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_io/fsw/src</span>.
</p>
</li>
<li>
<p>
Create a <span style="color: fuchsia;">temp_io_msg_for_grnd.h</span> by copying from <span style="color: fuchsia;">temp_io_msg.h</span>.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cp temp_io_msg.h temp_io_msg_for_grnd.h</tt></pre>
</div></div>
</li>
<li>
<p>
Edit <span style="color: fuchsia;">temp_io_msg_for_grnd.h</span> <a href="temp-io-msg-for-grnd-h1.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
Go to directory, <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_mon/src</span>.
</p>
</li>
<li>
<p>
Create a <span style="color: fuchsia;">temp_mon_msg_for_grnd.h</span> by copying from <span style="color: fuchsia;">temp_mon_msg.h</span>.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cp temp_mon_msg.h temp_mon_msg_for_grnd.h</tt></pre>
</div></div>
</li>
<li>
<p>
Edit <span style="color: fuchsia;">temp_mon_msg_for_grnd.h</span> <a href="temp-mon-msg-for-grnd-h1.html">LIKE THIS</a>.
</p>
</li>
</ol></div>
<h3 id="_updating_span_style_color_fuchsia_to_span_s_subscription_table_and_span_style_color_fuchsia_sch_span_s_scheduling_table">4.3. Updating <span style="color: fuchsia;">TO</span>'s subscription table and <span style="color: fuchsia;">SCH</span>'s scheduling table</h3><div style="clear:left"></div>
<h4 id="_adding_new_data_subscriptions_to_span_style_color_fuchsia_to_span_for_downlink">4.3.1. Adding new data subscriptions to <span style="color: fuchsia;">TO</span> for downlink</h4>
<div class="paragraph"><p><span style="color: fuchsia;">TO</span>'s main role is to send telemetry off the flight system.
It uses a subscription table to track messages it needs to send off.
You now need to add 2 subscription entries for <span style="color: fuchsia;">temp_io</span> data &amp;
<span style="color: fuchsia;">temp_mon</span> data messages to that table.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">App Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/to</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">./fsw/tables/to_config.c</span>, <a href="to-config-c.html">LIKE SO</a>,
   to add <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> messages to <span style="color: fuchsia;">to</span>'s
   subscription table.
</p>
</li>
<li>
<p>
Also edit the file, <span style="color: fuchsia;">./CMakeLists.txt</span>, <a href="to-cmake.html">LIKE THIS</a>,
   to include paths to <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> header files for
   <span style="color: fuchsia;">to</span>'s build of its table.
</p>
</li>
</ol></div>
<h4 id="_scheduling_the_new_applications_with_span_style_color_fuchsia_sch_span">4.3.2. Scheduling the new applications with <span style="color: fuchsia;">SCH</span></h4>
<div class="paragraph"><p>In order for the new applications to do any "work", <span style="color: fuchsia;">SCH</span>
has to send <span style="color: green;">Wake-Up</span> command to them. Similarly, in order
for the applications to send its telemetry, <span style="color: fuchsia;">sch</span> has to
send <span style="color: green;">Send-Hk</span> comand to them. You need to add new
scheduling entries for <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> to
do so.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">App Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/sch/</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">./fsw/tables/sch_def_msgtbl.c</span>, <a href="sch-msgtbl-c.html">LIKE THIS</a>,
   to add <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> messages to <span style="color: fuchsia;">sch</span> message table.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">./fsw/tables/sch_def_schtbl.c</span>, <a href="sch-schtbl-c.html">LIKE SO</a>,
   to schedule <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> to run @ 1Hz.
</p>
</li>
<li>
<p>
And edit the file, <span style="color: fuchsia;">./CMakeLists.txt</span>, <a href="sch-cmake.html">LIKE THIS</a>,
   to include paths to <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> header files for
   <span style="color: fuchsia;">sch</span>'s build of its tables.
</p>
</li>
</ol></div>
<h3 id="_building_the_new_flight_system">4.4. Building the new flight system</h3><div style="clear:left"></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory, <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101</span>.
</p>
</li>
<li>
<p>
Add <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> to the <span style="color: fuchsia;">cpu1</span> build by editing the file, <span style="color: fuchsia;">./cfs101_defs/targets.cmake</span>, <a href="targets-cmake.html">LIKE SO</a>.
</p>
</li>
<li>
<p>
Also add them to the startup script by editing the file, <span style="color: fuchsia;">./cfs101_defs/cpu1_cfe_es_startup.scr</span>, <a href="cfe-es-startup.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
Re-build the initial flight system with the following commands.
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ rm -rf build
$ make
$ make install</tt></pre>
</div></div>
<div class="paragraph"><p>Expect to see similar build output as the one in section titled,
<em style="color: navy;">Building the initial system</em>, but with additional entries for
<span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span>.<br />
<br />
See sample output for <a href="cmake-output2.html">make OUTPUT</a> and
<a href="cmake-install-output2.html">make install OUTPUT</a></p></div>
</li>
</ol></div>
<h3 id="_running_the_new_flight_system">4.5. Running the new flight system</h3><div style="clear:left"></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to the directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/build/cpu1/exe</span>
</p>
</li>
<li>
<p>
Run the new system by executing the following command,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ ./core-linux.bin</tt></pre>
</div></div>
<div class="paragraph"><p>Expect to see similar run output as the one in section titled,
<em style="color: navy;">Running the initial system</em>, but with additional entries relating to
<span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> applications.<br />
<br />
<a href="run-output2.html">HERE</a> is a sample output. Can you find where <span style="color: fuchsia;">temp_io</span>
&amp; <span style="color: fuchsia;">temp_mon</span> are loaded, and then initialized?</p></div>
</li>
</ol></div>
<h3 id="_interacting_with_the_new_flight_system">4.6. Interacting with the new flight system</h3><div style="clear:left"></div>
<div class="paragraph"><p>First you need to add a few things to the ground system for the new applications.</p></div>
<h4 id="_adding_ground_commands_for_the_new_applications">4.6.1. Adding ground commands for the new applications</h4>
<div class="paragraph"><p>Adding commands for the new applications is quite simple with the <span style="color: fuchsia;">cFE-GroundSystem</span>
tool.</p></div>
<h5 id="_creating_temp_io_commands">Creating temp_io commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">GSW Terminal</span>, go to directory,
<span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem/Subsystems/cmdGui</span>
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">CHeaderParser-hdr-paths.txt</span>, <a href="temp-io-headerparser-hdr-paths1.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
Execute the following command to generate the command file for <span style="color: fuchsia;">temp_io</span>,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python CHeaderParser.py</tt></pre>
</div></div>
</li>
<li>
<p>
Enter input, highlighted in green font, <a href="temp-io-msg-parsing-input1.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h5 id="_creating_temp_mon_commands">Creating temp_mon commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the same directory, <span style="color: fuchsia;">cmdGui</span>, re-edit the file,
   <span style="color: fuchsia;">CHeaderParser-hdr-paths.txt</span>, <a href="temp-mon-headerparser-hdr-paths1.html">LIKE SO</a>.
</p>
</li>
<li>
<p>
Re-execute the script,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python CHeaderParser.py</tt></pre>
</div></div>
</li>
<li>
<p>
Enter input, highlighted in green font, <a href="temp-mon-msg-parsing-input1.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h5 id="_adding_new_applications_to_the_command_pages">Adding new applications to the command pages</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the same directory, add the new command files to the
   command pages by editing the file, <span style="color: fuchsia;">command-pages.txt</span>,
   <a href="command-pages.html">LIKE THIS</a>.
</p>
</li>
</ol></div>
<h4 id="_sending_commands_to_the_new_flight_system">4.6.2. Sending commands to the new flight system</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, exit &amp; re-run the CFS executable,
   <span style="color: fuchsia;">core-linux.bin</span>.
</p>
</li>
<li>
<p>
Close out all the Ground System displays from the desktop.
</p>
</li>
<li>
<p>
From the <span style="color: orange;">GSW Terminal</span>, re-start the Ground System displays
   by executing the following commands:
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ cd /home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem
$ python GroundSystem.py</tt></pre>
</div></div>
</li>
<li>
<p>
From the <a href="ground-disp1.html">cFS Ground System</a> page, click on
   <a href="ground-disp1.html">Start Command System</a> button to bring up the
   <a href="cmdgui-disp2.html">Command System Main Page</a>.
</p>
</li>
</ol></div>
<h5 id="_sending_temp_io_commands">Sending temp_io commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="cmdgui-disp2.html">Command System Main Page</a>, click the
   <a href="cmdgui-disp2.html">Display Page</a> button for the <span style="color: green;">TEMP_IO Cmds (CPU1)</span> entry
   to bring up <span style="color: fuchsia;">temp_io</span> <a href="temp-io-cmd-disp1.html">command page</a>.
</p>
</li>
<li>
<p>
From there, send the following commands, in the order listed, to <span style="color: fuchsia;">temp_io</span>
   by clicking the <a href="temp-io-cmd-disp1.html">Send</a> buttons for
   <span style="color: green;">TEMP_IO_NOOP_CC</span>, <span style="color: green;">TEMP_IO_RESET_CC</span>, then <span style="color: green;">TEMP_IO_NOOP_CC</span> again.<br />
<br />
   You should see ground-system &amp; flight-system output similar to
   <a href="temp-io-cmd-output1.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message content and
   the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
</ol></div>
<h5 id="_sending_temp_mon_commands">Sending temp_mon commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="cmdgui-disp2.html">Command System Main Page</a>, click the
   <a href="cmdgui-disp2.html">Display Page</a> button for the <span style="color: green;">TEMP_MON Cmds (CPU1)</span> entry
   to bring up <span style="color: fuchsia;">temp_mon</span> <a href="temp-mon-cmd-disp1.html">command page</a>.
</p>
</li>
<li>
<p>
From there, send the following commands, in the order listed, to <span style="color: fuchsia;">temp_mon</span>
   by clicking the <a href="temp-mon-cmd-disp1.html">Send</a> buttons for
   <span style="color: green;">TEMP_MON_NOOP_CC</span>, <span style="color: green;">TEMP_MON_RESET_CC</span>, then <span style="color: green;">TEMP_MON_NOOP_CC</span>
   again.<br />
<br />
   You should see ground-system &amp; flight-system output similar to
   <a href="temp-mon-cmd-output1.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message content and
   the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
<li>
<p>
Close out all the Ground System displays.
</p>
</li>
</ol></div>
<h4 id="_adding_telemetry_from_the_new_applications_to_ground_system">4.6.3. Adding telemetry from the new applications to ground system</h4>
<div class="paragraph"><p>Like adding commands, adding telemetry for the new applications is quite simple
with <span style="color: fuchsia;">cFS-GroundSystem</span> tool.</p></div>
<h5 id="_creating_temp_io_telemetry">Creating temp_io telemetry</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">GSW Terminal</span>, go to directory,
<span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem/Subsystems/tlmGUI</span>
</p>
</li>
<li>
<p>
Create a new file called <span style="color: fuchsia;">cfs-temp-io-hk-tlm.txt</span> and edit <a href="temp-io-hk-tlm.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">cfs-temp-io-hk-tlm.txt</span> mirrors the definition of <span style="color: green;">TEMP_IO_HkTlm_t</span>
   defined in
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_io/fsw/src/temp_io_msg_for_grnd.h</span>.
</p>
</li>
<li>
<p>
Save &amp; close the file.
</p>
</li>
</ol></div>
<h5 id="_creating_temp_mon_telemetry">Creating temp_mon telemetry</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Similarly, create a new file called <span style="color: fuchsia;">cfs-temp-mon-hk-tlm.txt</span> and edit
   <a href="temp-mon-hk-tlm1.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
<span style="color: fuchsia;">cfs-temp-mon-hk-tlm.txt</span> mirrors the definition of <span style="color: green;">TEMP_MON_HkTlm_t</span>
   defined in
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_mon/fsw/src/temp_mon_msg_for_grnd.h</span>.
</p>
</li>
<li>
<p>
Save &amp; close the file.
</p>
</li>
</ol></div>
<h5 id="_adding_new_applications_to_the_telemetry_pages">Adding new applications to the telemetry pages</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Add the new telemetry files to the telemetry pages by editing the file,
   <span style="color: fuchsia;">telemetry-pages.txt</span>, <a href="telemetry-pages.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h4 id="_receiving_telemetry_from_the_new_flight_system">4.6.4. Receiving telemetry from the new flight system</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Start up the Ground System displays again from directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem</span>,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python GroundSystem.py</tt></pre>
</div></div>
</li>
<li>
<p>
From the <a href="ground-disp2.html">cFS Ground System</a> display, click the
   <a href="ground-disp2.html">Start Telemetry System</a> button
   to bring up the <a href="tlmgui-disp3.html">Telemetry System Main Page</a>.<br />
<br />
   You should expect to see no telemetry update from
   <a href="tlmgui-disp3.html">Telemetry System Main Page</a> at this point. This is
   because telemetry output from the flight system hasn&#8217;t been enabled yet.
</p>
</li>
<li>
<p>
So, from the <a href="cmdgui-disp3.html">Command System Main Page</a>, click the
   <a href="cmdgui-disp3.html">Display Page</a> button for to <span style="color: green;">TO Commands (CPU1)</span>
   entry to open the <a href="to-cmd-disp2.html">TO Commands (CPU1)</a> page.
</p>
</li>
<li>
<p>
From there, click the <a href="to-cmd-disp2.html">Send</a> button for
   <span style="color: green;">TO_ENABLE_OUTPUT_CC</span> command to bring up its
   <a href="to-cmd-param-disp1.html">Parameter Dialog</a> display.
</p>
</li>
<li>
<p>
From there, enter "<span style="color: green;">127.0.0.1</span>" in the input box for the <span style="color: green;">cDestIp</span>
   parameter, and "<span style="color: green;">5011</span>" in the input box for the <span style="color: green;">usDestPort</span>
   parameter. Then click the <a href="to-cmd-param-disp1.html">Send</a> button at the top
   of the display page.<br />
<br />
   You should see ground-system &amp; flight-system output similar to
   <a href="to-enable-cmd-output.html">THIS</a>.<br />
<br />
   The ground system prints out information about the command message
   content and the destination for every command sent. The flight system prints out
   acknowledgements from the applications upon receiving their commands.
</p>
</li>
<li>
<p>
Now from the <a href="tlmgui-disp4.html">Telemetry System Main Page</a>, you should
   expect to see telemetry updates periodically as the ground system receives
   telemetry from the flight system.
</p>
</li>
</ol></div>
<h5 id="_checking_out_application_specific_telemetry">Checking out application-specific telemetry</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Close the <span style="color: green;">Telemetry System Main Page</span>.
</p>
</li>
<li>
<p>
From the <a href="ground-disp3.html">cFS Ground System</a> display,
   select "<span style="color: green;">127.0.0.1</span>" from the
   <span style="color: green;">Selected IP Address</span> pull-down menu at the top of the display.
</p>
</li>
<li>
<p>
From there, click the <a href="ground-disp4.html">Start Telemetry System</a> button
   to re-open the <a href="tlmgui-disp4.html">Telemetry System Main Page</a>.
</p>
</li>
<li>
<p>
From there, click on the <a href="tlmgui-disp5.html">Display Page</a> button for the
   <span style="color: green;">Temp Monitor</span> entry to bring up <a href="temp-mon-tlm-disp1.html">Temp Monitor</a>
   telemetry page.
</p>
</li>
<li>
<p>
From the <a href="cmdgui-disp2.html">Command System Main Page</a>, bring up
   <a href="temp-mon-cmd-disp1.html">TEMP_MON Cmds (CPU1)</a> and send a few
   <span style="color: green;">TEMP_MON_NOOP_CC</span> commands.<br />
<br />
   You should expect to see its <a href="temp-mon-tlm-disp2.html">Command Counter</a> value
   increased by the number of commands you just sent.<br />
<br />
   If you send a <span style="color: green;">TEMP_MON_RESET_CC</span> command, all counter values will be
   reset to 0.
</p>
</li>
<li>
<p>
You can apply steps 4 &amp; 5 on <span style="color: fuchsia;">temp_io</span> if you want to see its telemetry
   updated.
</p>
</li>
<li>
<p>
At this point feel free to play with the system. When you are done,
   clear out the desktop for the next section by closing all the Ground System
   displays and exit the FSW run from the <span style="color: orange;">FSW Terminal</span>.
</p>
</li>
</ol></div>
<h3 id="_what_8217_s_next_2">4.7. What&#8217;s next?</h3><div style="clear:left"></div>
<div class="paragraph"><p>If you get to this point, CONGRATULATIONS AGAIN!!! You&#8217;ve just added new
applications to your initial CFS-based system.<br />
<br />
By now you have seen how CFS applications are created and integrated into
the system. If you take a closer look at the application&#8217;s generated code,
there are "TO-DO" comments that should guide you where you can add code to
enhance your application. There is also a generated <span style="color: fuchsia;">ReadMe.txt</span>
file in the <span style="color: fuchsia;">src</span> directory of the application that describes how
a CFS application works.</p></div>
<div class="paragraph"><p>You can stop here and venture out on your own at this point. However, if you
want to see in details how to enhance an application, you should continue
with the tutorial. In the next section, you will add more functions to
<span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span>.</p></div>
<div class="paragraph"><p>Take another coffee break before diving into it. You deserve it!<br />
<br />
<br /></p></div>
<hr />
<div class="paragraph"><p><span class="image">
<img src="Images/Pics/coffee-break.jpg" alt="Images/Pics/coffee-break.jpg" />
</span></p></div>
<hr />
</div>
<h2 id="_making_enhancements_to_the_new_flight_system">5. Making Enhancements To The New Flight System</h2>
<div class="sectionbody">
<div class="paragraph"><p>Now that you successfully integrated the 2 new applications,
<span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span>, to the CFS-based system,
you can now focus on just the code that needs to be added to the
new applications to cover the rest of the system&#8217;s functionalities.</p></div>
<h3 id="_modifying_temp_io">5.1. Modifying temp_io</h3><div style="clear:left"></div>
<div class="paragraph"><p>Let&#8217;s summarize <span style="color: fuchsia;">temp_io</span>'s functions again.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
It can process the following commands:
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
<span style="color: green;">Wake-Up</span> &amp; <span style="color: green;">Send-Hk</span>
</p>
</li>
<li>
<p>
<span style="color: green;">No-Op</span> &amp; <span style="color: green;">Reset</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Current-Temp</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Delta-Value</span>
</p>
</li>
</ol></div>
</li>
<li>
<p>
It reads data from a temperature sensor (simulated)
</p>
</li>
<li>
<p>
It publishes the new temperature.
</p>
</li>
<li>
<p>
It runs @ 1Hz.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The initial application code, generated by the script in the previous section,
takes care of items 1a &amp; 1b. Item 4 is also done when you add a
<span style="color: green;">Wake-Up</span> command entry to the <span style="color: fuchsia;">sch</span>'s scheduling table.
Item 2 will be a simulated sensor read by adding the current temperature value to a
settable delta value.</p></div>
<div class="paragraph"><p>You need to add more code to cover the rest of the functions, starting with
additional commands.</p></div>
<h4 id="_adding_more_commands">5.1.1. Adding more commands</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">App Terminal</span>, go to directory
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_io/fsw/src</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_io_msg.h</span>, <a href="temp-io-msg-h.html">LIKE SO</a>
   to add command codes for the new command messages.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_io_private_types.h</span>,
   <a href="temp-io-private-types-h1.html">LIKE SO</a> to add data structures for
   the new command messages.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_io_app.h</span>, <a href="temp-io-app-h.html">LIKE THIS</a> to define
   some local variables to be used for generating simulated sensor data.
</p>
</li>
<li>
<p>
Edit the function, <span style="color: green;">TEMP_IO_ProcessNewAppCmds()</span>, in the source file,
   <span style="color: fuchsia;">temp_io_app.c</span>, <a href="temp-io-processnewappcmds-c.html">LIKE THIS</a> to handle
   command responses.
</p>
</li>
</ol></div>
<div class="paragraph"><p>As you can see from the modified code, <span style="color: green;">TEMP_IO_SET_CURRENT_TEMP_CC</span> command
will set the current temperature value to the commanded value. Similarly,
<span style="color: green;">TEMP_IO_SET_DELTA_VALUE_CC</span> command will set the current delta value
to the commanded value.</p></div>
<h4 id="_reading_data">5.1.2. Reading data</h4>
<div class="paragraph"><p>To simulate sensor data read, <span style="color: fuchsia;">temp_io</span> generates the new temperature
value by adding the current temperature value to the current delta value.<br /></p></div>
<div class="paragraph"><p>This is done at the beginning of every <span style="color: green;">Wakeup</span> cycle for
<span style="color: fuchsia;">temp_io</span>, which is currently @ 1Hz.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Edit the following functions in the file, <span style="color: fuchsia;">temp_io_app.c</span>,
   <a href="temp-io-processnewdata-c.html">LIKE SO</a>,
</p>
<div class="ulist"><ul>
<li>
<p>
<span style="color: green;">TEMP_IO_InitData()</span> to initialize local variables
</p>
</li>
<li>
<p>
<span style="color: green;">TEMP_IO_ProcessNewData()</span> to compute simulated sensor values
</p>
</li>
</ul></div>
</li>
</ol></div>
<h4 id="_publishing_data">5.1.3. Publishing data</h4>
<div class="paragraph"><p>To publish temperature data for other apps to consume, you need to modify
<span style="color: fuchsia;">temp_io</span>'s code as follow.<br /></p></div>
<div class="paragraph"><p>This is done at the end of every <span style="color: green;">Wakeup</span> cycle for <span style="color: fuchsia;">temp_io</span>.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_io_private_types.h</span>,
   <a href="temp-io-private-types-h2.html">LIKE THIS</a>, to add
   data for publication using <span style="color: green;">TEMP_IO_OutData_t</span> data
   structure.
</p>
</li>
<li>
<p>
Edit the function, <span style="color: green;">TEMP_IO_SendOutData()</span> in the source file,
   <span style="color: fuchsia;">temp_io_app.c</span>, <a href="temp-io-sendoutdata-c.html">LIKE THIS</a>
   to publish the data.
</p>
</li>
</ol></div>
<h3 id="_modifying_temp_mon">5.2. Modifying temp_mon</h3><div style="clear:left"></div>
<div class="paragraph"><p>Let&#8217;s summarize <span style="color: fuchsia;">temp_mon</span>'s functions again.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
It can process the following commands:
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
<span style="color: green;">Wake-Up</span> &amp; <span style="color: green;">Send-Hk</span>
</p>
</li>
<li>
<p>
<span style="color: green;">No-Op</span> &amp; <span style="color: green;">Reset</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Cold-Limit</span>
</p>
</li>
<li>
<p>
<span style="color: green;">Set-Hot-Limit</span>
</p>
</li>
</ol></div>
</li>
<li>
<p>
It gets the new temperature value &amp; saves current value as old value
</p>
</li>
<li>
<p>
It compares &amp; determines if the value has increased/decreased,
       compares &amp; determines which range, nominal/hot/cold, the value falls in.
</p>
</li>
<li>
<p>
It publishes temperature direction &amp; range.
</p>
</li>
<li>
<p>
It runs @ 1Hz.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The initial application code, generated by the script in the previous section,
takes care of items 1a &amp; 1b. Item 5 is also done when you add a
<span style="color: green;">Wake-Up</span> command entry to the <span style="color: fuchsia;">sch</span>'s scheduling table.</p></div>
<div class="paragraph"><p>You need to add more code to cover the rest of the functions, starting with
additional commands.</p></div>
<h4 id="_adding_more_commands_2">5.2.1. Adding more commands</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">App Terminal</span>, go to directory
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_mon/fsw/src</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_msg.h</span>, <a href="temp-mon-msg-h1.html">LIKE SO</a>,
   to add command codes for the new command messages.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_private_types.h</span>,
   <a href="temp-mon-private-types-h.html">LIKE SO</a>, to add data structures for
   the new command messages.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_app.h</span>, <a href="temp-mon-app-h.html">LIKE SO</a>,
   to declare variables used to track data.
</p>
</li>
<li>
<p>
Edit the function, <span style="color: green;">TEMP_MON_ProcessNewAppCmds()</span>, in the source file,
   <span style="color: fuchsia;">temp_mon_app.c</span>, <a href="temp-mon-processnewappcmds-c.html">LIKE THIS</a>,
   to handle command responses.
</p>
</li>
</ol></div>
<h4 id="_computing_data">5.2.2. Computing data</h4>
<div class="paragraph"><p>To determine temperature direction &amp; range, <span style="color: fuchsia;">temp_mon</span> looks at
previous &amp; current temperatures as well as temperature limits.<br /></p></div>
<div class="paragraph"><p>This is done at the beginning of every <span style="color: green;">Wakeup</span> cycle for
<span style="color: fuchsia;">temp_mon</span>, which is currently @ 1Hz.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_msg.h</span>,
   <a href="temp-mon-msg-h2.html">LIKE THIS</a> to define some macro
   constants used in determining range &amp; direction.
</p>
</li>
<li>
<p>
Edit the following functions in the file, <span style="color: fuchsia;">temp_io_app.c</span>,
   <a href="temp-mon-processnewdata-c.html">LIKE SO</a>,
</p>
<div class="ulist"><ul>
<li>
<p>
include <span style="color: fuchsia;">temp_io</span> header file, <span style="color: green;">temp_io_private_types.h</span>
</p>
</li>
<li>
<p>
<span style="color: green;">TEMP_MON_InitData()</span> to initialize the local variables
</p>
</li>
<li>
<p>
<span style="color: green;">TEMP_MON_InitPipe()</span> to subscribe to <span style="color: fuchsia;">temp_io</span> data
</p>
</li>
<li>
<p>
<span style="color: green;">TEMP_MON_ProcessNewData()</span> to determine temperature range
     &amp; direction
</p>
</li>
</ul></div>
</li>
</ol></div>
<h4 id="_publishing_data_2">5.2.3. Publishing data</h4>
<div class="paragraph"><p>To publish data for downlink to the ground system, you need to modify
<span style="color: fuchsia;">temp_mon</span>'s code as follow.<br /></p></div>
<div class="paragraph"><p>This is done when <span style="color: fuchsia;">temp_mon</span> receives a <span style="color: green;">TEMP_MON_SEND_HK_MID</span>
command message from the <span style="color: fuchsia;">sch</span>.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_msg.h</span>,
   <a href="temp-mon-msg-h3.html">LIKE THIS</a>, to add data for publication
   using <span style="color: green;">TEMP_MON_HkTlm_t</span> data structure.
</p>
</li>
<li>
<p>
Edit the function, <span style="color: green;">TEMP_MON_ReportHousekeeping()</span> in the source file,
   <span style="color: fuchsia;">temp_mon_app.c</span>, <a href="temp-mon-reporthousekeeping-c.html">LIKE THIS</a>
   to publish the data.
</p>
</li>
</ol></div>
<h3 id="_building_the_enhanced_flight_system">5.3. Building the enhanced flight system</h3><div style="clear:left"></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/</span>.
</p>
</li>
<li>
<p>
Execute the following commands,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ rm -rf build
$ make
$ make install</tt></pre>
</div></div>
<div class="paragraph"><p>Expect to see similar output like <a href="cmake-output2.html">THIS</a> &amp;
<a href="cmake-install-output2.html">THIS</a>.</p></div>
</li>
</ol></div>
<h3 id="_running_the_enhanced_flight_system">5.4. Running the enhanced flight system</h3><div style="clear:left"></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/build/cpu1/exe</span>.
</p>
</li>
<li>
<p>
Executing the following command,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ ./core-linux.bin</tt></pre>
</div></div>
<div class="paragraph"><p>Expect to see similar output <a href="run-output2.html">THIS</a>. Can you spot
what else is being output from your <span style="color: orange;">FSW Terminal</span>?</p></div>
</li>
</ol></div>
<h3 id="_interacting_with_the_enhanced_flight_system">5.5. Interacting with the enhanced flight system</h3><div style="clear:left"></div>
<h4 id="_adding_more_ground_commands">5.5.1. Adding more ground commands</h4>
<div class="paragraph"><p>You need to add the new ground commands for <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span>
applications.</p></div>
<h5 id="_creating_new_temp_io_commands">Creating new temp_io commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_io/fsw/src</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_io_msg_for_grnd.h</span>,
   <a href="temp-io-msg-for-grnd-h2.html">LIKE SO</a>.
</p>
</li>
<li>
<p>
From the <span style="color: orange;">GSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem/Subsystems/cmdGui</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">CHeaderParser-hdr-paths.txt</span>,
   <a href="temp-io-headerparser-hdr-paths2.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
Execute the following command to generate new command file for <span style="color: fuchsia;">temp_io</span>,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python CHeaderParser.py</tt></pre>
</div></div>
</li>
<li>
<p>
Enter input, highlighted in green font, <a href="temp-io-msg-parsing-input2.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h5 id="_creating_new_temp_mon_commands">Creating new temp_mon commands</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <span style="color: orange;">FSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/temp_mon/fsw/src</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">temp_mon_msg_for_grnd.h</span>,
   <a href="temp-mon-msg-for-grnd-h2.html">LIKE SO</a>.
</p>
</li>
<li>
<p>
From the <span style="color: orange;">GSW Terminal</span>, go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem/Subsystems/cmdGui</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">CHeaderParser-hdr-paths.txt</span>,
   <a href="temp-mon-headerparser-hdr-paths2.html">LIKE THIS</a>.
</p>
</li>
<li>
<p>
Execute the following command to generate new command file for <span style="color: fuchsia;">temp_mon</span>,
</p>
<div class="literalblock">
<div class="content">
<pre><tt>$ python CHeaderParser.py</tt></pre>
</div></div>
</li>
<li>
<p>
Enter input, highlighted in green font, <a href="temp-mon-msg-parsing-input2.html">LIKE SO</a>.
</p>
</li>
</ol></div>
<h4 id="_sending_commands_to_the_enhanced_flight_system">5.5.2. Sending commands to the enhanced flight system</h4>
<div class="paragraph"><p>Now see if you can send new commands to the modified system and get
data feedbacks. The steps are exactly like those in the section,
<em style="color: navy;">Sending commands to the new flight system</em>.</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Changes in <span style="color: fuchsia;">temp_io</span> command displays
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="temp-io-cmd-disp2.html">TEMP_IO Cmds (CPU1)</a> page has additional commands.
</p>
</li>
<li>
<p>
<a href="temp-io-cmd-param-disp1.html">Parameter Dialog</a> for
     <span style="color: green;">TEMP_IO_SET_CURRENT_TEMP_CC</span> command is new.
</p>
</li>
<li>
<p>
<a href="temp-io-cmd-param-disp2.html">Parameter Dialog</a> for
     <span style="color: green;">TEMP_IO_SET_DELTA_VALUE_CC</span> command is new.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Changes in <span style="color: fuchsia;">temp_mon</span> command displays
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="temp-mon-cmd-disp2.html">TEMP_MON Cmds (CPU1)</a> page has additional commands.
</p>
</li>
<li>
<p>
<a href="temp-mon-cmd-param-disp1.html">Parameter Dialog</a> for
     <span style="color: green;">TEMP_MON_SET_COLD_LIMIT_CC</span> is new.
</p>
</li>
<li>
<p>
<a href="temp-mon-cmd-param-disp2.html">Parameter Dialog</a> for
     <span style="color: green;">TEMP_MON_SET_HOT_LIMIT_CC</span> is new.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Now send some of the new commands to the enhanced flight system.<br />
<br />
   From the <a href="temp-io-cmd-disp2.html">TEMP_IO Cmds (CPU1)</a> page,
</p>
<div class="ulist"><ul>
<li>
<p>
Send <span style="color: green;">TEMP_IO_SET_CURRENT_TEMP_CC</span> to set current temperature to <span style="color: green;">101</span>
</p>
</li>
<li>
<p>
Send <span style="color: green;">TEMP_IO_SET_DELTA_VALUE_CC</span> to set delta value to <span style="color: green;">10</span>
<br />
   When you set the current temperature, expect to see from the FSW output that
   temperature value has jumped to the set value before it continues to increase by 1
   again. Then, when you set the delta value, temperature value should be increasing by
   the newly set delta value.
</p>
</li>
</ul></div>
</li>
<li>
<p>
And from the <a href="temp-mon-cmd-disp2.html">TEMP_MON Cmds (CPU1)</a> page,
</p>
<div class="ulist"><ul>
<li>
<p>
Send <span style="color: green;">TEMP_MON_SET_COLD_LIMIT_CC</span> to set cold limit at <span style="color: green;">-10</span>
</p>
</li>
<li>
<p>
Send <span style="color: green;">TEMP_MON_SET_HOT_LIMIT_CC</span> to set hot limit at <span style="color: green;">200</span>
</p>
</li>
</ul></div>
</li>
</ol></div>
<div class="paragraph"><p>You should see output similar to <a href="temp-io-cmd-output2.html">THIS</a>
and <a href="temp-mon-cmd-output2.html">THIS</a>.</p></div>
<h4 id="_receiving_telemetry_from_the_enhanced_flight_system">5.5.3. Receiving telemetry from the enhanced flight system</h4>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Go to directory,
   <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/tools/cFS-GroundSystem/Subsystems/tlmGUI</span>.
</p>
</li>
<li>
<p>
Edit the file, <span style="color: fuchsia;">cfs-temp-mon-hk-tlm.txt</span>,
   <a href="temp-mon-hk-tlm2.html">LIKE THIS</a>, to describe temperature data being
   downlinked.
</p>
</li>
<li>
<p>
Send <span style="color: green;">TO_ENABLE_OUTPUT_CC</span> command to <span style="color: fuchsia;">to</span> to enable
   telemetry output. (See <em style="color: navy;">Receiving telemetry from the new flight system</em>.)
</p>
</li>
</ol></div>
<h5 id="_checking_out_application_specific_telemetry_2">Checking out application-specific telemetry</h5>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
From the <a href="ground-disp3.html">cFS Ground System</a> display, select
   <span style="color: green;">127.0.0.1</span> from the <span style="color: green;">Selected IP Address</span> pull-down menu at
   the top of the display.
</p>
</li>
<li>
<p>
Click the <a href="ground-disp4.html">Start Telemetry System</a> button to bring
   up <a href="tlmgui-disp4.html">Telemetry System Main Page</a>.
</p>
</li>
<li>
<p>
From there, click on the <a href="tlmgui-disp5.html">Display Page</a> button for the
   <span style="color: green;">Temp Monitor</span> entry to bring up <a href="temp-mon-tlm-disp3.html">Temp Monitor</a>
   telemetry page.
</p>
</li>
<li>
<p>
Now send <span style="color: fuchsia;">temp_io</span> &amp; <span style="color: fuchsia;">temp_mon</span> commands to the flight
   system and watch <span style="color: fuchsia;">temp_mon</span> telemetry gets updated.
</p>
<div class="ulist"><ul>
<li>
<p>
Send a <span style="color: green;">TEMP_IO_SET_CURRENT_TEMP_CC</span> command to reset the current
     temperature value.
</p>
</li>
<li>
<p>
Send a <span style="color: green;">TEMP_IO_SET_DELTA_VALUE_CC</span> command to change the update
     rate of the current temperature. If the delta value goes from positive
     to negative, or vice versa, the temperature direction should eventually
     change as well.
</p>
</li>
<li>
<p>
Send a <span style="color: green;">TEMP_MON_SET_COLD_LIMIT_CC</span> command to change the cold
     threshold value. When the current temperature is less than the cold
     threshold value, the temperature range should change.
</p>
</li>
<li>
<p>
Send a <span style="color: green;">TEMP_MON_SET_HOT_LIMIT_CC</span> command to change the hot
     threshold value. When the current temperature is greater than the hot
     threshold value, the temperature range should change.
</p>
</li>
</ul></div>
</li>
</ol></div>
<h3 id="_what_8217_s_next_3">5.6. What&#8217;s next?</h3><div style="clear:left"></div>
<div class="paragraph"><p>The primary objective of this training is to give you a feel
for how new capabilities can be quickly &amp; easily added to the system
just by using the CFE framework, its applications and tools. Hopefully
this training has achieved that. :-)</p></div>
<div class="paragraph"><p>There are many things you can do from this point on. You can expand
the system further by either adding more functionalities to the
existing applications or add new applications. How about reconfiguring
some of the existing applications? For example, <span style="color: fuchsia;">sch</span> application is running
@ 100Hz by default. Why not configure it to run @ 40Hz? Which header and/or
source files do you have to modified? While you&#8217;re at it,
look at the detailed design document &amp; user&#8217;s guide for <span style="color: fuchsia;">sch</span> application.
They should be at <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/apps/sch/docs</span>.</p></div>
<div class="paragraph"><p>If you&#8217;re interested in learning more about the CFE framework itself,
take a look at <span style="color: fuchsia;">/home/dev/Training_workspace/CFS-101/cfe/docs</span>.</p></div>
<div class="paragraph"><p>You might also be interested in the <a href="qnas.html">Q&amp;A</a> section as well.</p></div>
</div>
<h2 id="_the_end">6. The end?</h2>
<div class="sectionbody">
<div class="paragraph"><p>Thank you for your interest &amp; happy coding!!!<br />
<br />
<br /></p></div>
<div class="paragraph"><p><span class="image">
<img src="Images/Pics/graduation-cap.jpg" alt="Images/Pics/graduation-cap.jpg" />
</span></p></div>
</div>
<h2 id="_questions_amp_answers">7. Questions &amp; Answers</h2>
<div class="sectionbody">
<div class="paragraph"><p>Click <a href="qnas.html">HERE</a> for more details.</p></div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-07-17 14:53:19 CDT
</div>
</div>
</body>
</html>
